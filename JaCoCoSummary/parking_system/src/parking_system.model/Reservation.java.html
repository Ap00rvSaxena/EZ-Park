<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../jacoco-resources/report.gif" type="image/gif"/><title>Reservation.java</title><link rel="stylesheet" href="../../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">Merged (Apr 30, 2019 2:10:14 AM)</a> &gt; <a href="../../index.html" class="el_group">parking_system</a> &gt; <a href="../index.html" class="el_bundle">src</a> &gt; <a href="index.source.html" class="el_package">parking_system.model</a> &gt; <span class="el_source">Reservation.java</span></div><h1>Reservation.java</h1><pre class="source lang-java linenums">package parking_system.model;

import java.text.DecimalFormat;
import java.util.Arrays;
import java.util.Calendar;
import java.util.List;
import java.util.TimeZone;

<span class="fc" id="L9">public class Reservation {</span>
	
	private String username;
	private String reservationid;
	private String starttime;
	private String endtime;
	private String permit;
	private String parkingarea;
	private String floor;
	private String parkingspot;
	private String cancelled;
	private String resvdate;
	private String violation;
	private String vehiclenumber;
	private String cart;
	private String camera;
	private String history;
	private String payment;
	private String spotID;
	
	private String userPermit;
	private String cardNumber;
	private String cvv;
	private String currTime;
	
<span class="fc" id="L34">	private static DecimalFormat decimalFormat = new DecimalFormat(&quot;.##&quot;);</span>
	
	public void setReservation(String username, String reservationid, String starttime, String endtime, String permit, String parkingarea,
			String floor, String parkingspot, String cancelled, String resvdate, String violation, String vehiclenumber,
			String cart, String camera, String history, String payment, String spotID) {
<span class="fc" id="L39">		setUsername(username);</span>
<span class="fc" id="L40">		setReservationid(reservationid);</span>
<span class="fc" id="L41">		setStarttime(starttime);</span>
<span class="fc" id="L42">		setEndtime(endtime);</span>
<span class="fc" id="L43">		setPermit(permit);</span>
<span class="fc" id="L44">		setParkingarea(parkingarea);</span>
<span class="fc" id="L45">		setFloor(floor);</span>
<span class="fc" id="L46">		setParkingspot(parkingspot);</span>
<span class="fc" id="L47">		setCancelled(cancelled);</span>
<span class="fc" id="L48">		setResvdate(resvdate);</span>
<span class="fc" id="L49">		setViolation(violation);</span>
<span class="fc" id="L50">		setVehiclenumber(vehiclenumber);</span>
<span class="fc" id="L51">		setCart(cart);</span>
<span class="fc" id="L52">		setCamera(camera);</span>
<span class="fc" id="L53">		setHistory(history);</span>
<span class="fc" id="L54">		setPayment(payment);</span>
<span class="fc" id="L55">		setSpotID(spotID);</span>
<span class="fc" id="L56">	}</span>
		
	public String getUsername() {
<span class="fc" id="L59">		return username;</span>
	}
	public void setUsername(String username) {
<span class="fc" id="L62">		this.username = username;</span>
<span class="fc" id="L63">	}</span>
	public String getReservationid() {
<span class="fc" id="L65">		return reservationid;</span>
	}
	public void setReservationid(String reservationid) {
<span class="fc" id="L68">		this.reservationid = reservationid;</span>
<span class="fc" id="L69">	}</span>
	public String getStarttime() {
<span class="fc" id="L71">		return starttime;</span>
	}
	public void setStarttime(String starttime) {
<span class="fc" id="L74">		this.starttime = starttime;</span>
<span class="fc" id="L75">	}</span>
	public String getEndtime() {
<span class="fc" id="L77">		return endtime;</span>
	}
	public void setEndtime(String endtime) {
<span class="fc" id="L80">		this.endtime = endtime;</span>
<span class="fc" id="L81">	}</span>
	public String getPermit() {
<span class="fc" id="L83">		return permit;</span>
	}
	public void setPermit(String permit) {
<span class="fc" id="L86">		this.permit = permit;</span>
<span class="fc" id="L87">	}</span>
	public String getParkingarea() {
<span class="fc" id="L89">		return parkingarea;</span>
	}
	public void setParkingarea(String parkingarea) {
<span class="fc" id="L92">		this.parkingarea = parkingarea;</span>
<span class="fc" id="L93">	}</span>
	public String getFloor() {
<span class="fc" id="L95">		return floor;</span>
	}
	public void setFloor(String floor) {
<span class="fc" id="L98">		this.floor = floor;</span>
<span class="fc" id="L99">	}</span>
	public String getParkingspot() {
<span class="fc" id="L101">		return parkingspot;</span>
	}
	public void setParkingspot(String parkingspot) {
<span class="fc" id="L104">		this.parkingspot = parkingspot;</span>
<span class="fc" id="L105">	}</span>
	public String getCancelled() {
<span class="fc" id="L107">		return cancelled;</span>
	}
	public void setCancelled(String cancelled) {
<span class="fc" id="L110">		this.cancelled = cancelled;</span>
<span class="fc" id="L111">	}</span>
	public String getResvdate() {
<span class="fc" id="L113">		return resvdate;</span>
	}
	public void setResvdate(String date) {
<span class="fc" id="L116">		this.resvdate = date;</span>
<span class="fc" id="L117">	}</span>
	public String getViolation() {
<span class="fc" id="L119">		return violation;</span>
	}
	public void setViolation(String violation) {
<span class="fc" id="L122">		this.violation = violation;</span>
<span class="fc" id="L123">	}</span>
	public String getVehiclenumber() {
<span class="fc" id="L125">		return vehiclenumber;</span>
	}
	public void setVehiclenumber(String vehiclenumber) {
<span class="fc" id="L128">		this.vehiclenumber = vehiclenumber;</span>
<span class="fc" id="L129">	}</span>
	public String getCart() {
<span class="fc" id="L131">		return cart;</span>
	}
	public void setCart(String cart) {
<span class="fc" id="L134">		this.cart = cart;</span>
<span class="fc" id="L135">	}</span>
	public String getCamera() {
<span class="fc" id="L137">		return camera;</span>
	}
	public void setCamera(String camera) {
<span class="fc" id="L140">		this.camera = camera;</span>
<span class="fc" id="L141">	}</span>
	public String getHistory() {
<span class="fc" id="L143">		return history;</span>
	}
	
	public void setHistory(String history) {
<span class="fc" id="L147">		this.history = history;</span>
<span class="fc" id="L148">	}</span>
	
	public String getPayment() {
<span class="fc" id="L151">		return payment;</span>
	}
	
	public void setPayment(String payment) {
<span class="fc" id="L155">		this.payment = payment;</span>
<span class="fc" id="L156">	}</span>
	
	public String getUserPermit() {
<span class="fc" id="L159">		return userPermit;</span>
	}

	public void setUserPermit(String userPermit) {
<span class="fc" id="L163">		this.userPermit = userPermit;</span>
<span class="fc" id="L164">	}</span>

	public String getCardNumber() {
<span class="fc" id="L167">		return cardNumber;</span>
	}

	public void setCardNumber(String cardNumber) {
<span class="fc" id="L171">		this.cardNumber = cardNumber;</span>
<span class="fc" id="L172">	}</span>

	public String getCvv() {
<span class="fc" id="L175">		return cvv;</span>
	}

	public void setCvv(String cvv) {
<span class="fc" id="L179">		this.cvv = cvv;</span>
<span class="fc" id="L180">	}</span>

	public String getSpotID() {
<span class="fc" id="L183">		return spotID;</span>
	}

	public void setSpotID(String spotID) {
<span class="fc" id="L187">		this.spotID = spotID;</span>
<span class="fc" id="L188">	}</span>
	
	public String getCurrTime() {
<span class="fc" id="L191">		return currTime;</span>
	}

	public void setCurrTime(String currTime) {
<span class="fc" id="L195">		this.currTime = currTime;</span>
<span class="fc" id="L196">	}</span>
	
	public String calculatePayment(String[] options, int currentDay, String endtime) {
<span class="fc" id="L199">		double finamount = 0;</span>
<span class="fc" id="L200">		double histValue = 1.95;</span>
<span class="fc" id="L201">		double cameraValue = 2.95;</span>
<span class="fc" id="L202">		double cartValue = 15.95;</span>
		//System.out.println(&quot;In resv Opt Array: &quot; + Arrays.toString(options));
<span class="fc" id="L204">		List&lt;String&gt; optionsList = Arrays.asList(options);</span>
		
<span class="fc bfc" id="L206" title="All 2 branches covered.">		if (optionsList.contains(&quot;hist&quot;)){</span>
<span class="fc" id="L207">			finamount+= histValue;</span>
<span class="fc" id="L208">			setHistory(&quot;1&quot;);</span>
<span class="fc" id="L209">		}</span>
		else
<span class="fc" id="L211">			setHistory(&quot;0&quot;);</span>
		
<span class="fc bfc" id="L213" title="All 2 branches covered.">		if(optionsList.contains(&quot;cam&quot;)) {</span>
<span class="fc" id="L214">			finamount+= cameraValue;</span>
<span class="fc" id="L215">			setCamera(&quot;1&quot;);</span>
<span class="fc" id="L216">		}</span>
		else
<span class="fc" id="L218">			setCamera(&quot;0&quot;);</span>
		
<span class="fc bfc" id="L220" title="All 2 branches covered.">		if (optionsList.contains(&quot;cart&quot;)){</span>
<span class="fc bfc" id="L221" title="All 2 branches covered.">			if ( currentDay == 1){</span>
<span class="fc bfc" id="L222" title="All 4 branches covered.">				if (Integer.parseInt(endtime) &lt; 1200 || Integer.parseInt(endtime) &gt; 1700)</span>
<span class="fc" id="L223">					finamount+= 2*cartValue;</span>
				else
<span class="fc" id="L225">					finamount+= cartValue;</span>
<span class="fc" id="L226">			}</span>
<span class="fc bfc" id="L227" title="All 2 branches covered.">			else if(currentDay == 7){</span>
<span class="fc bfc" id="L228" title="All 4 branches covered.">				if (Integer.parseInt(endtime) &lt; 800 || Integer.parseInt(endtime) &gt; 1700)</span>
<span class="fc" id="L229">					finamount+= 2*cartValue;</span>
				else
<span class="fc" id="L231">					finamount+= cartValue;</span>
<span class="fc" id="L232">			}</span>
			else{
<span class="fc bfc" id="L234" title="All 4 branches covered.">				if (Integer.parseInt(endtime) &lt; 600 || Integer.parseInt(endtime) &gt; 2000)</span>
<span class="fc" id="L235">					finamount+= 2*cartValue;</span>
				else
<span class="fc" id="L237">					finamount+= cartValue;</span>
			}
<span class="fc" id="L239">			setCart(&quot;1&quot;);</span>
<span class="fc" id="L240">		}</span>
		else
<span class="fc" id="L242">			setCart(&quot;0&quot;);</span>
		//System.out.println(&quot;In Reserv Cam: &quot; + getCamera()+ &quot; His: &quot; + getHistory() + &quot; Cart: &quot; + getCart());
<span class="fc" id="L244">		return decimalFormat.format(finamount);</span>
	}
	
	public String generateSpotID(String parkingArea, String floor, String resPermit, int parkingSpot) {
<span class="fc" id="L248">		StringBuilder spotId = new StringBuilder();</span>
<span class="fc bfc" id="L249" title="All 2 branches covered.">		if (parkingArea.equals(&quot;West Garage&quot;))</span>
<span class="fc" id="L250">			spotId.append(&quot;WG&quot;);</span>
<span class="fc bfc" id="L251" title="All 2 branches covered.">		else if (parkingArea.equals(&quot;Maverick&quot;))</span>
<span class="fc" id="L252">			spotId.append(&quot;MV&quot;);</span>
<span class="fc bfc" id="L253" title="All 2 branches covered.">		else if (parkingArea.equals(&quot;Nedderman&quot;))</span>
<span class="fc" id="L254">			spotId.append(&quot;ND&quot;);</span>
		else //if (parkingArea.equals(&quot;Davis&quot;))
<span class="fc" id="L256">			spotId.append(&quot;DV&quot;);</span>
		
<span class="fc bfc" id="L258" title="All 2 branches covered.">		if (floor.equals(&quot;1&quot;))</span>
<span class="fc" id="L259">			spotId.append(&quot;1F&quot;);</span>
<span class="fc bfc" id="L260" title="All 2 branches covered.">		else if (floor.equals(&quot;2&quot;))</span>
<span class="fc" id="L261">			spotId.append(&quot;2F&quot;);</span>
<span class="fc bfc" id="L262" title="All 2 branches covered.">		else if (floor.equals(&quot;3&quot;))</span>
<span class="fc" id="L263">			spotId.append(&quot;3F&quot;);</span>
<span class="fc bfc" id="L264" title="All 2 branches covered.">		else if (floor.equals(&quot;4&quot;))</span>
<span class="fc" id="L265">			spotId.append(&quot;4F&quot;);</span>
		else //if (floor.equals(&quot;5&quot;))
<span class="fc" id="L267">			spotId.append(&quot;5F&quot;);</span>
		
<span class="fc bfc" id="L269" title="All 2 branches covered.">		if (resPermit.equals(&quot;BASIC&quot;))</span>
<span class="fc" id="L270">			spotId.append(&quot;B&quot;);</span>
<span class="fc bfc" id="L271" title="All 2 branches covered.">		else if (resPermit.equals(&quot;MIDRANGE&quot;))</span>
<span class="fc" id="L272">			spotId.append(&quot;M&quot;);</span>
<span class="fc bfc" id="L273" title="All 2 branches covered.">		else if (resPermit.equals(&quot;PREMIUM&quot;))</span>
<span class="fc" id="L274">			spotId.append(&quot;P&quot;);</span>
		else //if (resPermit.equals(&quot;ACCESS&quot;))
<span class="fc" id="L276">			spotId.append(&quot;A&quot;);</span>
		
<span class="fc" id="L278">		spotId.append(String.valueOf(parkingSpot));</span>
		//System.out.println(&quot;In ReservationModel:&quot;+ spotId + &quot; PA:&quot; + parkingArea);
<span class="fc" id="L280">		return String.valueOf(spotId);</span>
	}
	
	
	public void  validateReservation(String action, Reservation reservation, ReservationErrorMsgs errorMsg){
<span class="fc bfc" id="L285" title="All 2 branches covered.">		if(action.equalsIgnoreCase(&quot;searchP&quot;)){</span>
<span class="fc" id="L286">			errorMsg.setTimeError(validateTime(action, reservation.getStarttime(),reservation.getEndtime(), reservation.getCurrTime()));</span>
<span class="fc" id="L287">			errorMsg.setErrorMsg(action);</span>
<span class="fc" id="L288">		}</span>
<span class="fc bfc" id="L289" title="All 2 branches covered.">		else if(action.equalsIgnoreCase(&quot;finalPayment&quot;)){</span>
<span class="fc" id="L290">			errorMsg.setPermitError(validatePermit(action, reservation.getUserPermit(),reservation.getPermit()));</span>
<span class="fc" id="L291">			errorMsg.setErrorMsg(action);</span>
<span class="fc" id="L292">		}</span>
		else{
<span class="fc" id="L294">			errorMsg.setCardNumberError(validateCard(action, reservation.getCardNumber()));</span>
<span class="fc" id="L295">			errorMsg.setCvvError(validateCVV(action, reservation.getCvv()));</span>
<span class="fc" id="L296">			errorMsg.setErrorMsg(action);</span>
		}
<span class="fc" id="L298">	}</span>
	
	private String validateTime(String action, String starttime, String endtime, String currTime) {
<span class="fc" id="L301">		String msg = &quot;&quot;;</span>
<span class="fc bfc" id="L302" title="All 2 branches covered.">		if (Integer.parseInt(endtime) &lt;= Integer.parseInt(starttime))</span>
<span class="fc" id="L303">			msg = &quot;End time should be greater than start time&quot;;</span>
<span class="fc bfc" id="L304" title="All 2 branches covered.">		else if ((Integer.parseInt(endtime)-Integer.parseInt(starttime) &gt; 300))</span>
<span class="fc" id="L305">			msg = &quot;Duration of reservation cannot be greater than 3 hours&quot;;</span>
<span class="fc bfc" id="L306" title="All 2 branches covered.">		else if((Integer.parseInt(currTime)-Integer.parseInt(starttime) &gt; 0))</span>
<span class="fc" id="L307">			msg = &quot;Start time should be greater than Current time&quot;;</span>
<span class="fc" id="L308">		return msg;</span>
	}
	
	private String validatePermit(String action, String userPermit, String resPermit) {
<span class="fc" id="L312">		String msg= &quot;&quot;;</span>
<span class="fc bfc" id="L313" title="All 4 branches covered.">		if (userPermit.equals(&quot;ACCESS&quot;) &amp;&amp; !resPermit.equals(&quot;ACCESS&quot;)){</span>
<span class="fc" id="L314">			msg = &quot;ACCESS User can only book an Access Parking type&quot;;</span>
<span class="fc" id="L315">		}</span>
<span class="fc bfc" id="L316" title="All 4 branches covered.">		else if(userPermit.equals(&quot;PREMIUM&quot;) &amp;&amp; resPermit.equals(&quot;ACCESS&quot;)){</span>
<span class="fc" id="L317">			msg = &quot;PREMIUM User cannot book an Access Parking type&quot;;</span>
<span class="fc" id="L318">		}</span>
<span class="fc bfc" id="L319" title="All 6 branches covered.">		else if (userPermit.equals(&quot;MIDRANGE&quot;) &amp;&amp; (resPermit.equals(&quot;ACCESS&quot;) || resPermit.equals(&quot;PREMIUM&quot;))){</span>
<span class="fc" id="L320">			msg = &quot;MIDRANGE User cannot book an ACCESS or PREMIUM Parking type&quot;;</span>
<span class="fc" id="L321">		}</span>
<span class="fc bfc" id="L322" title="All 4 branches covered.">		else if (userPermit.equals(&quot;BASIC&quot;) &amp;&amp; !resPermit.equals(&quot;BASIC&quot;)){</span>
<span class="fc" id="L323">			msg = &quot;BASIC User can only book an BASIC Parking type&quot;;</span>
		}
<span class="fc" id="L325">		return msg;</span>
	}
	

	private String validateCard(String action, String number){
<span class="fc" id="L330">		String msg = &quot;&quot;;</span>
<span class="fc bfc" id="L331" title="All 2 branches covered.">		if(number.length() == 0){</span>
<span class="fc" id="L332">			msg = &quot;Please provide your Card number&quot;;</span>
<span class="fc" id="L333">		}</span>

<span class="fc bfc" id="L335" title="All 2 branches covered.">		else if(number.length()!=16){</span>
<span class="fc" id="L336">			msg = &quot;Card number should be 16 characters long&quot;;</span>
<span class="fc" id="L337">		}</span>
<span class="fc bfc" id="L338" title="All 2 branches covered.">		else if (!isTextAnInteger(number)){</span>
<span class="fc" id="L339">			msg=&quot;Card Number must be a number&quot;;</span>
			}
<span class="fc" id="L341">		return msg;</span>
	}
	
	private String validateCVV(String action, String number) {
<span class="fc" id="L345">		String msg = &quot;&quot;;</span>
<span class="fc bfc" id="L346" title="All 2 branches covered.">		if(number.length() == 0){</span>
<span class="fc" id="L347">			msg = &quot;Please provide your CVV number&quot;;</span>
<span class="fc" id="L348">		}</span>
<span class="fc bfc" id="L349" title="All 2 branches covered.">		else if (!isTextAnInteger(number)){</span>
<span class="fc" id="L350">			msg=&quot;CVV must be a number&quot;;</span>
<span class="fc" id="L351">			}</span>
<span class="fc bfc" id="L352" title="All 4 branches covered.">		else if(number.length() &gt; 4 || number.length() &lt; 3){</span>
<span class="fc" id="L353">			msg = &quot;CVV number must be 3 or 4 digit only&quot;;</span>
		}
<span class="fc" id="L355">		return msg;</span>
	}
	
	private boolean isTextAnInteger (String string) {
        boolean result;
		try
        {
<span class="fc" id="L362">            Long.parseLong(string);</span>
<span class="fc" id="L363">            result=true;</span>
<span class="fc" id="L364">        } </span>
<span class="fc" id="L365">        catch (NumberFormatException e) </span>
        {
<span class="fc" id="L367">            result=false;</span>
        }
<span class="fc" id="L369">		return result;</span>
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span>Merged (Apr 30, 2019 2:10:14 AM)</div></body></html>